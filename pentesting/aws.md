---
icon: aws
---

# AWS

## AWS CLI

Credentials are stored by default in `~/.aws/credentials`

```bash
# Get identity of users credentials
aws sts get-caller-identity
```

### Enumerating Users Info

#### Users

```bash
aws iam list-users
```

#### User Policies

```bash
aws iam list-user-policies --user-name [username]
aws iam list-attached-user-policies --user-name [username]
aws iam get-user-policy --policy-name [policyname] --user-name [username]
```

#### User Groups

```bash
aws iam list-groups-for-user --user-name [username]
```

### AssumeRole

If the user's policy has the sts:AssumeRole action, we can check the roles available

{% code overflow="wrap" %}
```bash
aws iam list-roles

# And Assume Role
aws sts assume-role --role-arn [rolearn] --role-session-name [anything]

# then export the creds
export AWS_ACCESS_KEY_ID="xxxxxxxxxxxx"
export AWS_SECRET_ACCESS_KEY="abcd1234xxxxxxxxxxxx"
export AWS_SESSION_TOKEN="FwoGZXIvYXdzEJr..."

# check identity
aws sts get-caller-identity
```
{% endcode %}

### List Bucket Contents

{% code overflow="wrap" %}
```bash
aws s3api list-buckets

# List bucket objects
aws s3api list-objects --bucket [bucket]

# Get object
aws s3api get-object --bucket [bucket] --key [key] [output file]

```
{% endcode %}
